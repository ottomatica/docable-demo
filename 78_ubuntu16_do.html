<!DOCTYPE html><html lang="en"><head>
    <title>How To Install Concourse CI on Ubuntu 16.04 | DigitalOcean</title>

<meta name="description" content="Concourse CI is a modern, scalable continuous integration system designed to automate testing pipelines with a composable, declarative syntax. In this tutorial, we will demonstrate how to install Concourse CI on an Ubuntu 16.04 server. We will configu">
<meta name="keywords" content="PostgreSQL CI/CD">

<meta name="og:title" content="How To Install Concourse CI on Ubuntu 16.04 | DigitalOcean">
<meta name="og:description" content="Concourse CI is a modern, scalable continuous integration system designed to automate testing pipelines with a composable, declarative syntax. In this tutorial, we will demonstrate how to install Concourse CI on an Ubuntu 16.04 server. We will configu">
<meta name="og:site_name" content="DigitalOcean">
<meta name="og:type" content="article">
<meta name="og:image" content="https://www.digitalocean.com/assets/community/illustrations/DigitalOcean_Community-02cc36407e7a978ed4fc9ed98f3ed87c.jpg">

<meta name="twitter:site" content="DigitalOcean">
<meta name="twitter:title" content="How To Install Concourse CI on Ubuntu 16.04 | DigitalOcean">
<meta name="twitter:description" content="Concourse CI is a modern, scalable continuous integration system designed to automate testing pipelines with a composable, declarative syntax. In this tutorial, we will demonstrate how to install Concourse CI on an Ubuntu 16.04 server. We will configu">
<meta name="twitter:creator" content="DigitalOcean">
<meta name="twitter:card" content="photo">
<meta name="twitter:url" content="https://www.digitalocean.com/community/tutorials/how-to-install-concourse-ci-on-ubuntu-16-04">
<meta name="twitter:image" content="https://www.digitalocean.com/assets/community/illustrations/DigitalOcean_Community-02cc36407e7a978ed4fc9ed98f3ed87c.jpg">

  <link rel="canonical" href="https://www.digitalocean.com/community/tutorials/how-to-install-concourse-ci-on-ubuntu-16-04">

<link rel="preconnect" href="https://digitalocean.cdn.prismic.io">
<link rel="preconnect" href="https://hello.myfonts.net">


    <link rel="stylesheet" media="all" href="/assets/community/application-b828e623bec3c41208f9f701850222a0.css">

    
    <meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="syV/UYAVDeG55AXMItpri0YM7ig21z13bcZK5wLupRRDwjGjzabtVmbcs9I3NdeVjKPPozF1O9l4tVATkQRyIA==">
    <script src="/assets/community/prerequisites-9a51dfaadf0d3629cc636286133a958d.js"></script>
    <script>
//<![CDATA[

  window.cookieDomain = '.digitalocean.com';

//]]>
</script><script src="https://assets.digitalocean.com/cookieConsent/cookieConsent.js"></script>
<link rel="stylesheet" href="https://assets.digitalocean.com/cookieConsent/cookieConsent.css">

    <script type="text/javascript">
  if(window.analytics=window.analytics||[],window.analytics.included)window.console&&console.error&&console.error("analytics.js included twice");else{window.analytics.included=!0,window.analytics.methods=["identify","group","track","page","pageview","alias","ready","on","once","off","trackLink","trackForm","trackClick","trackSubmit"],window.analytics.factory=function(a){return function(){var n=Array.prototype.slice.call(arguments);return n.unshift(a),window.analytics.push(n),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var key=window.analytics.methods[i];window.analytics[key]=window.analytics.factory(key)}window.analytics.load=function(a){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+a+"/analytics.min.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(n,t)},window.analytics.SNIPPET_VERSION="2.0.9",window.analytics.load("puo3uv968t")}
  window.analytics.page();
</script>


<script src="/assets/community/internalCookies-d2a3579f6b37d00c8045b16853b90462.js"></script>

      <script src="https://cdn.polyfill.io/v2/polyfill.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


    <link rel="alternate" type="application/rss+xml" title="RSS" href="/community/tutorials/feed">
    <script>
      window.comApp = {
        prefix: '/community',
        svgIconPath: 'https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg',
        railsEnv: 'production',
        rootUrl: 'https://www.digitalocean.com/community',
        algolia_application_id: '6ZHEUVKJ88',
        algolia_api_key: 'c5470567eae7fa1177d43222e18ba086'
      };
    </script>
      <script src="https://go.digitalocean.com/js/forms2/js/forms2.min.js"></script>

    <script src="/assets/community/application-dd2f12c7d68945c016e67a784d8785fc.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css">
                            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
                            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css"><style>
                        .markdown-body {
                            box-sizing: border-box;
                            min-width: 200px;
                            max-width: 980px;
                            margin: 0 auto;
                            padding: 45px;
                        }
                    
                        @media (max-width: 767px) {
                            .markdown-body {
                                padding: 15px;
                            }
                        }

                        .passing { background-color: #e6ffe6 !important }
                             .failing { background-color: #ffe6e6 !important }
                        .verify { padding: 20px; width: 100%; white-space: pre-wrap}
                    </style></head>
  <body class="feature-filter-bar feature-upvotes tutorials-controller tutorial-single markdown-body" data-env="production" data-prefix="/community" data-user-id data-facebook-app-id="694818843983011" data-completed-tutorial-id data-tutorial-id="2339" data-js="tutorial" data-upvote="null" data-flagged>
    



    <h1 class="content-title Tutorial-header">How To Install Concourse CI on Ubuntu 16.04</h1>

    <span class="meta-section timestamp"><span class="tutorial-date-text">Posted</span><span class="tutorial-date">May 26, 2017</span></span>

    <span class="meta-section pageviews"><span class="icon icon-eye v-mid"></span><span class="views-count v-mid">29.6k</span><span class="sr-only"> views</span></span>

    <span class="meta-section tags">
      <a class="tag" href="/community/tags/ci-cd?type=tutorials">CI/CD</a> <a class="tag" href="/community/tags/postgresql?type=tutorials">PostgreSQL</a>
      <a class="tag" href="/community/tags/ubuntu?type=tutorials">Ubuntu</a> <a class="tag" href="/community/tags/ubuntu-16-04?type=tutorials">Ubuntu 16.04</a>
    </span>
  </div>

  <div class="tutorial-authors">
    <div class="component-collaborators-container">
  <ul class="component-collaborators-content">
        <li class="collaborator-byline-avatar">
          <a href="/community/users/jellingwood">
            <img alt="jellingwood" class="avatar avatar-large" src="../steps/https:/secure.gravatar.com/avatar/60d901f61a6146e14a3e989bc1f4ef11?secure=true&amp;d=identicon" width="80" height="80">
</a>        </li>

    <li class="collaborators-byline-data">
        <p class="names">By <a href="/community/users/jellingwood">Justin Ellingwood</a></p>

      <p>
          <a class="advice" href="https://www.digitalocean.com/community/write-for-digitalocean">Become an author</a>
      </p>
    </li>
  </ul>
</div>

  </div>


    <div class="content-body tutorial-content" data-growable-markdown>
      
      <h3 id="introduction">Introduction</h3>

<p><a href="https://concourse.ci/">Concourse CI</a> is a modern, scalable continuous integration system designed to automate testing pipelines with a composable, declarative syntax.  Building off of the success of earlier CI systems, Concourse aims to simplify pipeline management and eliminate &#x201C;snowflake&#x201D; servers so that the testing server is as well regulated as the code it processes.</p>

<p>In this tutorial, we will demonstrate how to install Concourse CI on an Ubuntu 16.04 server.  We will configure a PostgreSQL database to use as the backend, download and install the Concourse binaries, and then configure the web and worker processes that allow us to build and execute continuous integration pipelines.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>To complete this guide, you will need an Ubuntu 16.04 server with at least <strong>1 GB of RAM</strong>.  Configure a non-root <code>sudo</code> user and a firewall as described in the <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-16-04">Ubuntu 16.04 initial server setup guide</a> before continuing.</p>

<h2 id="install-and-configure-postgresql">Install and Configure PostgreSQL</h2>

<p>Before we download the Concourse CI binaries, we should set up a PostgreSQL instance on our server.  Concourse will use the PostgreSQL database to store its pipeline data.</p>

<p>First, update the local package index to refresh the local view of available files.  Afterwards, install the <code>postgresql</code> and <code>postgresql-contrib</code> packages from Ubuntu&#x2019;s default repositories:</p>
<pre class="code-pre command passing"><span>&#x2713; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo apt-get update
</li><li class="line" prefix="$">sudo apt-get install postgresql postgresql-contrib
</li></ul></code></pre>
<p>Once the database software is installed, we will create a dedicated PostgreSQL user named <code>concourse</code> to manage the Concourse assets within the database system.  To create this user, we will use <code>sudo</code> to act as the <code>postgres</code> system user, which has admin access to the database system:</p>
<pre class="code-pre command passing"><span>&#x2713; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo -u postgres createuser concourse
</li></ul></code></pre>
<p>By default, Concourse attempts to connect to a database called <code>atc</code>.  Concourse calls its main web and API hub the &#x201C;ATC&#x201D;, which stands for &#x201C;air traffic control&#x201D;.  We can create this database and assign ownership to the <code>concourse</code> database user to provide appropriate access:</p>
<pre class="code-pre command passing"><span>&#x2713; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo -u postgres createdb --owner=concourse atc
</li></ul></code></pre>
<p>With our database in place, we are now ready to download and install the Concourse CI binaries.</p>

<h2 id="download-and-install-the-concourse-ci-executables">Download and Install the Concourse CI Executables</h2>

<p>Concourse provides links to compiled executables for the Linux platform on both their website and GitHub.</p>

<p>The easiest place to find them is on the <a href="https://github.com/concourse/concourse/releases">Concourse CI download page</a>.  In the <strong>Downloads</strong> section, under the <strong>Concourse Binaries</strong> section, right-click and copy the link location for the <strong>Linux</strong> platform download.  Keep this page open, as we will be coming back to it momentarily.</p>

<p>On your server, switch to the <code>/tmp</code> directory and then use <code>curl</code> to download the link you copied:</p>
<pre class="code-pre command failing"><span>&#x10102; </span><code langs><ul class="prefixed"><li class="line" prefix="$">cd /tmp
</li><li class="line" prefix="$">curl -LO <span class="highlight">copied_URL_for_concourse_binary</span>
</li></ul></code><br><br><span>&#xFE0F;&#x2755;error: curl: Remote file name has no length!
curl: try &apos;curl --help&apos; or &apos;curl --manual&apos; for more information
</span><span> exit code: 23</span><span> command output:<br> </span></pre>
<p>Next, we will download the latest <code>fly</code> command line client.  Back on the <a href="https://github.com/concourse/concourse/releases">Concourse CI download page</a>, in the <strong>Downloads</strong> section, under the <strong>Fly Binaries</strong> section, right-click and copy the link location for the <strong>Linux</strong> platform download.</p>

<p>On your server, download the copied link to <code>/tmp</code> again with <code>curl</code>:</p>
<pre class="code-pre command failing"><span>&#x10102; </span><code langs><ul class="prefixed"><li class="line" prefix="$">cd /tmp
</li><li class="line" prefix="$">curl -LO <span class="highlight">copied_URL_for_fly_binary</span>
</li></ul></code><br><br><span>&#xFE0F;&#x2755;error: curl: Remote file name has no length!
curl: try &apos;curl --help&apos; or &apos;curl --manual&apos; for more information
</span><span> exit code: 23</span><span> command output:<br> </span></pre>
<p>If the download request resulted in an error, the files will contain an HTTP error message instead of a binary program.  Check that the files are actually binary executables by typing:</p>
<pre class="code-pre command failing"><span>&#x10102; </span><code langs><ul class="prefixed"><li class="line" prefix="$">file *linux_amd64 | grep executable
</li></ul></code><br><br><span>&#xFE0F;&#x2755;error: </span><span> exit code: 1</span><span> command output:<br> </span></pre><pre class="code-pre "><code langs><div class="secondary-code-label " title="Output">Output</div>concourse_linux_amd64: ELF 64-bit LSB <span class="highlight">executable</span>, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=3f24eae5da950594d8d1aaea7631bc20883afba3, not stripped
fly_linux_amd64:       ELF 64-bit LSB <span class="highlight">executable</span>, x86-64, version 1 (SYSV), statically linked, not stripped
</code></pre>
<p>The above output indicates that the files are executables.  We can add executable permission to the files, remove the <code>_linux_amd64</code> suffix, and move them to the <code>/usr/local/bin</code> directory by typing:</p>
<pre class="code-pre command failing"><span>&#x10102; </span><code langs><ul class="prefixed"><li class="line" prefix="$">chmod +x concourse* fly*
</li><li class="line" prefix="$">sudo mv concourse* /usr/local/bin/concourse
</li><li class="line" prefix="$">sudo mv fly* /usr/local/bin/fly
</li></ul></code><br><br><span>&#xFE0F;&#x2755;error: chmod: cannot access &apos;concourse*&apos;: No such file or directory
chmod: cannot access &apos;fly*&apos;: No such file or directory
mv: cannot stat &apos;concourse*&apos;: No such file or directory
mv: cannot stat &apos;fly*&apos;: No such file or directory
</span><span> exit code: 1</span><span> command output:<br> </span></pre>
<p>Asking for the version of each program will serve as a small check to make sure everything is operating correctly:</p>
<pre class="code-pre command failing"><span>&#x10102; </span><code langs><ul class="prefixed"><li class="line" prefix="$">cd ~
</li><li class="line" prefix="$">concourse --version
</li><li class="line" prefix="$">fly --version
</li></ul></code><br><br><span>&#xFE0F;&#x2755;error: bash: line 1: concourse: command not found
bash: line 2: fly: command not found
</span><span> exit code: 127</span><span> command output:<br> </span></pre><pre class="code-pre "><code langs><div class="secondary-code-label " title="Output">Output</div><span class="highlight">3.0.1</span>
<span class="highlight">3.0.1</span>
</code></pre>
<p>Now that our binaries are in place, we can begin configuring Concourse.</p>

<h2 id="create-the-concourse-ci-configuration-assets">Create the Concourse CI Configuration Assets</h2>

<p>Next, we can start to put together the configuration and keys that Concourse will use to start up.</p>

<p>Before we begin, create a configuration directory where we can keep all of the relevant files:</p>
<pre class="code-pre command passing"><span>&#x2713; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo mkdir /etc/concourse
</li></ul></code></pre>
<p>We can now generate encryption keys and create files that define our Concourse configuration.</p>

<h3 id="creating-the-key-files">Creating the Key Files</h3>

<p>Concourse is composed of a few related components that all need to be able to communicate securely with one another.</p>

<p>The <a href="https://concourse.ci/architecture.html#architecture-atc">ATC</a> is the main hub that handles web and API requests and coordinates pipelines.  <a href="https://concourse.ci/architecture.html#architecture-worker">Workers</a> manage containers to run the CI/CD tasks defined in the pipeline. The <a href="https://concourse.ci/architecture.html#architecture-tsa">TSA</a> is a custom SSH server that securely registers workers with the ATC.</p>

<p>Even though we will be running all of these components on a single server, the worker and TSA expect to communicate securely.  To satisfy this expectation, we will create three sets of keys:</p>

<ul>
<li>a key pair for the TSA component</li>
<li>a key pair for the worker</li>
<li>a session signing key pair used to sign tokens for user sessions and TSA to ATC communication</li>
</ul>

<p>Since these will be used automatically when each of the components start up, we need to create these keys without a password.  We can create each of these key pairs in the <code>/etc/concourse</code> directory by typing:</p>
<pre class="code-pre command passing"><span>&#x2713; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo ssh-keygen -t rsa -q -N &apos;&apos; -f /etc/concourse/tsa_host_key
</li><li class="line" prefix="$">sudo ssh-keygen -t rsa -q -N &apos;&apos; -f /etc/concourse/worker_key
</li><li class="line" prefix="$">sudo ssh-keygen -t rsa -q -N &apos;&apos; -f /etc/concourse/session_signing_key
</li></ul></code></pre>
<p>If we check in the concourse directory, we can see that three public and three private keys are now available:</p>
<pre class="code-pre command passing"><span>&#x2713; </span><code langs><ul class="prefixed"><li class="line" prefix="$">ls -l /etc/concourse
</li></ul></code></pre><pre class="code-pre "><code langs><div class="secondary-code-label " title="Output">Output</div>total 24
-rw------- 1 root root 1679 May 11 17:19 session_signing_key
-rw-r--r-- 1 root root  394 May 11 17:19 session_signing_key.pub
-rw------- 1 root root 1679 May 11 17:19 tsa_host_key
-rw-r--r-- 1 root root  394 May 11 17:19 tsa_host_key.pub
-rw------- 1 root root 1675 May 11 17:19 worker_key
-rw-r--r-- 1 root root  394 May 11 17:19 worker_key.pub
</code></pre>
<p>The TSA will decide which workers are authorized to connect to the system by checking an authorized key file.  We need to  pre-populate the authorized keys file with the worker&#x2019;s public key that we generated so that it can connect successfully.</p>

<p>Since this is our only worker, we can just copy the file over:</p>
<pre class="code-pre command passing"><span>&#x2713; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo cp /etc/concourse/worker_key.pub /etc/concourse/authorized_worker_keys
</li></ul></code></pre>
<p>Now that we have the key files and an initial file for authorized workers, we can create the files that will define our Concourse configuration.</p>

<h3 id="creating-the-environment-configuration-files">Creating the Environment Configuration Files</h3>

<p>The Concourse binary does not read from a configuration file natively.  However, it can take configuration values from environment variables passed in when the process starts.</p>

<p>In a moment, we will be creating <code>systemd</code> unit files to define and manage our Concourse services.  The unit files can read environment variables from a file and pass them to the process as it starts.  We will create a file that defines the variables for the Concourse <code>web</code> process, which start the ATC and TSA components, and another file for the Concourse <code>worker</code> process.</p>

<p>Create and open a file for the <code>web</code> process by typing:</p>
<pre class="code-pre command"><code langs><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/concourse/web_environment
</li></ul></code></pre>
<p>Inside, we will define the environment variables needed by the ATC and TSA components.  Each variable begins with <code>CONCOURSE_</code>.</p>

<p>To start, we will define some static values that we don&#x2019;t need to modify.  These variables will define the location of the private TSA and session keys, the file defining the authorized workers, and the PostgreSQL socket location:</p>
<div class="code-label " title="/etc/concourse/web_environment">/etc/concourse/web_environment</div><pre class="code-pre  failing"><span>&#x10102; </span><code langs># These values can be used as-is
CONCOURSE_SESSION_SIGNING_KEY=/etc/concourse/session_signing_key
CONCOURSE_TSA_HOST_KEY=/etc/concourse/tsa_host_key
CONCOURSE_TSA_AUTHORIZED_KEYS=/etc/concourse/authorized_worker_keys
CONCOURSE_POSTGRES_SOCKET=/var/run/postgresql
</code><br><br><span>&#xFE0F;&#x2755;error: tee: /etc/concourse/web_environment: Permission denied
</span><span> exit code: undefined</span><span> command output:<br> undefined</span></pre>
<p>Next, we&#x2019;ll set some variables that will need to be changed to match your environment.  The <code>CONCOURSE_EXTERNAL_URL</code> defines the IP address and port that the service will bind to.  Set this to your server&#x2019;s public IP address and port 8080.</p>

<p>We will also set a username and password for the <code>main</code> team, which functions as the Concourse administrative group.  You can select any username and password you&#x2019;d like here.  You can change the admin credentials at any time by modifying these values and restarting the service:</p>
<div class="code-label " title="/etc/concourse/web_environment">/etc/concourse/web_environment</div><pre class="code-pre  failing"><span>&#x10102; </span><code langs># These values can be used as-is
CONCOURSE_SESSION_SIGNING_KEY=/etc/concourse/session_signing_key
CONCOURSE_TSA_HOST_KEY=/etc/concourse/tsa_host_key
CONCOURSE_TSA_AUTHORIZED_KEYS=/etc/concourse/authorized_worker_keys
CONCOURSE_POSTGRES_SOCKET=/var/run/postgresql

# Change these values to match your environment
CONCOURSE_BASIC_AUTH_USERNAME=<span class="highlight">sammy</span>
CONCOURSE_BASIC_AUTH_PASSWORD=<span class="highlight">theshark</span>
CONCOURSE_EXTERNAL_URL=http://<span class="highlight">servers_public_IP</span>:8080
</code><br><br><span>&#xFE0F;&#x2755;error: tee: /etc/concourse/web_environment: Permission denied
</span><span> exit code: undefined</span><span> command output:<br> undefined</span></pre>
<p>Save and close the file when you are finished.</p>

<p>Next, create an environment file for the <code>worker</code> process:</p>
<pre class="code-pre command"><code langs><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/concourse/worker_environment
</li></ul></code></pre>
<p>Inside, we will define the locations of the worker&#x2019;s private key, the TSA&#x2019;s public key, and the directory where the worker will store its files.  We will also set the address where the TSA can be reached, which will be the localhost in our case.  You can use the values below without modification:</p>
<div class="code-label " title="/etc/concourse/worker_environment">/etc/concourse/worker_environment</div><pre class="code-pre  failing"><span>&#x10102; </span><code langs># These values can be used as-is
CONCOURSE_WORK_DIR=/var/lib/concourse
CONCOURSE_TSA_WORKER_PRIVATE_KEY=/etc/concourse/worker_key
CONCOURSE_TSA_PUBLIC_KEY=/etc/concourse/tsa_host_key.pub
CONCOURSE_TSA_HOST=127.0.0.1:2222
</code><br><br><span>&#xFE0F;&#x2755;error: tee: /etc/concourse/worker_environment: Permission denied
</span><span> exit code: undefined</span><span> command output:<br> undefined</span></pre>
<p>Save and close the file when you are finished.</p>

<h3 id="creating-a-dedicated-system-user-and-adjusting-permissions">Creating a Dedicated System User and Adjusting Permissions</h3>

<p>Before we move on, we should create a dedicated Linux user to run the Concourse <code>web</code> process.  This will allow us to start the web-facing service with limited privileges.</p>

<p>Because of the way that PostgreSQL handles authentication by default, it is important that the username match the PostgreSQL username we created earlier.  Create a system user and group called <code>concourse</code> by typing:</p>
<pre class="code-pre command passing"><span>&#x2713; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo adduser --system --group concourse
</li></ul></code></pre>
<p>We can give the new user ownership over the <code>/etc/concourse</code> directory and its contents by typing:</p>
<pre class="code-pre command passing"><span>&#x2713; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo chown -R concourse:concourse /etc/concourse
</li></ul></code></pre>
<p>The environment files contain some sensitive data like the administrative username and password for the CI server.  Adjust the permissions of the environment files so that regular users cannot read or modify the values in those files:</p>
<pre class="code-pre command failing"><span>&#x10102; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo chmod 600 /etc/concourse/*_environment
</li></ul></code><br><br><span>&#xFE0F;&#x2755;error: chmod: cannot access &apos;/etc/concourse/*_environment&apos;: No such file or directory
</span><span> exit code: 1</span><span> command output:<br> </span></pre>
<p>Our configuration assets are now owned by the <code>concourse</code> system user with limited privileges for other users.</p>

<h2 id="create-systemd-unit-files-for-the-web-and-worker-processes">Create Systemd Unit Files for the Web and Worker Processes</h2>

<p>We are now ready to define the Concourse CI unit files that will start and manage the application processes.  We will create one file for the <code>web</code> process that handles the TSA and ATC components and one file for the <code>worker</code> process that handles containers for pipeline tasks.</p>

<h3 id="creating-the-concourse-web-unit-file">Creating the Concourse Web Unit File</h3>

<p>Start by creating a <code>concourse-web.service</code> file within the <code>/etc/systemd/system</code> file:</p>
<pre class="code-pre command"><code langs><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/systemd/system/concourse-web.service
</li></ul></code></pre>
<p>Inside, paste the following contents:</p>
<div class="code-label " title="/etc/systemd/system/concourse-web.service">/etc/systemd/system/concourse-web.service</div><pre class="code-pre  passing"><span>&#x2713; </span><span>&#x2713; </span><code langs>[Unit]
Description=Concourse CI web process (ATC and TSA)
After=postgresql.service

[Service]
User=concourse
Restart=on-failure
EnvironmentFile=/etc/concourse/web_environment
ExecStart=/usr/local/bin/concourse web

[Install]
WantedBy=multi-user.target
</code></pre>
<p>The first section of the file sets the unit description for the <code>web</code> process and indicates that this unit should be started after the PostgreSQL unit when deciding on ordering.</p>

<p>The <code>[Service]</code> section defines the way that the service will be run.  We will run the service as the <code>concourse</code> user we configured earlier and we tell systemd to automatically restart the service if it fails, which can be useful if the process dies from memory constraints or similar issues.  We load the <code>web_environment</code> file we defined earlier to establish the environment and we start the actual process by calling <code>concourse web</code>.</p>

<p>The <code>[Install]</code> section tells systemd how to tie the unit to the system start order if we configure the service to start at boot.</p>

<p>Save and close the file when you are finished.</p>

<h3 id="creating-the-concourse-worker-unit-file">Creating the Concourse Worker Unit File</h3>

<p>Next, open a similar file to define the <code>worker</code> process:</p>
<pre class="code-pre command"><code langs><ul class="prefixed"><li class="line" prefix="$">sudo nano /etc/systemd/system/concourse-worker.service
</li></ul></code></pre>
<p>Inside, paste the following contents:</p>
<div class="code-label " title="/etc/systemd/system/concourse-worker.service">/etc/systemd/system/concourse-worker.service</div><pre class="code-pre "><code langs>[Unit]
Description=Concourse CI worker process
After=concourse-web.service

[Service]
User=root
Restart=on-failure
EnvironmentFile=/etc/concourse/worker_environment
ExecStart=/usr/local/bin/concourse worker

[Install]
WantedBy=multi-user.target
</code></pre>
<p>This unit functions similarly to the <code>concourse-web</code> unit.  This time, we tell system to start the <code>worker</code> process after the Concourse <code>web</code> process has been started.  The <code>worker</code> process is run as the <code>root</code> user instead of <code>concourse</code> because it requires administrative privileges for container management.  We load the <code>worker_environment</code> file and use the <code>concourse worker</code> command to start the process.</p>

<p>Save and close the file when you are finished.</p>

<h2 id="adjust-the-firewall-and-start-the-services">Adjust the Firewall and Start the Services</h2>

<p>With our unit files in place, we can now allow access through the firewall and start the services.</p>

<p>The <code>web</code> process will listen for connections on port 8080, so we need to open access to that port in the <code>ufw</code> firewall:</p>
<pre class="code-pre command passing"><span>&#x2713; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo ufw allow 8080
</li></ul></code></pre>
<p>The containers used by the <code>worker</code> process require forwarding access so that they can correctly reach the internet and resolve DNS queries.  We can enable this by typing:</p>
<pre class="code-pre command passing"><span>&#x2713; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo ufw default allow routed
</li></ul></code></pre>
<p>We can now start our services by typing:</p>
<pre class="code-pre command failing"><span>&#x10102; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo systemctl start concourse-web concourse-worker
</li></ul></code><br><br><span>&#xFE0F;&#x2755;error: Job for concourse-web.service failed because a configured resource limit was exceeded. See &quot;systemctl status concourse-web.service&quot; and &quot;journalctl -xe&quot; for details.
Job for concourse-worker.service failed because a configured resource limit was exceeded. See &quot;systemctl status concourse-worker.service&quot; and &quot;journalctl -xe&quot; for details.
</span><span> exit code: 1</span><span> command output:<br> </span></pre>
<p>We can check that both services were started correctly by typing:</p>
<pre class="code-pre command failing"><span>&#x10102; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo systemctl status concourse-web concourse-worker
</li></ul></code><br><br><span>&#xFE0F;&#x2755;error: </span><span> exit code: 3</span><span> command output:<br> &#x25CF; concourse-web.service - Concourse CI web process (ATC and TSA)
   Loaded: loaded (/etc/systemd/system/concourse-web.service; disabled; vendor preset: enabled)
   Active: activating (auto-restart) (Result: resources) since Fri 2020-01-10 16:37:54 UTC; 5ms ago
    Tasks: 0
   Memory: 0B
      CPU: 0

Jan 10 16:37:54 ubuntu-xenial systemd[1]: concourse-web.service: Service hold-off time over, scheduling restart.
Jan 10 16:37:54 ubuntu-xenial systemd[1]: Stopped Concourse CI web process (ATC and TSA).
Jan 10 16:37:54 ubuntu-xenial systemd[1]: concourse-web.service: Failed to load environment files: No such file or directory
Jan 10 16:37:54 ubuntu-xenial systemd[1]: concourse-web.service: Failed to run &apos;start&apos; task: No such file or directory
Jan 10 16:37:54 ubuntu-xenial systemd[1]: Failed to start Concourse CI web process (ATC and TSA).
Jan 10 16:37:54 ubuntu-xenial systemd[1]: concourse-web.service: Unit entered failed state.
Jan 10 16:37:54 ubuntu-xenial systemd[1]: concourse-web.service: Failed with result &apos;resources&apos;.

&#x25CF; concourse-worker.service
   Loaded: loaded (/etc/systemd/system/concourse-worker.service; bad; vendor preset: enabled)
   Active: activating (auto-restart) (Result: resources) since Fri 2020-01-10 16:37:54 UTC; 6ms ago

Jan 10 16:37:54 ubuntu-xenial systemd[1]: concourse-worker.service: Service hold-off time over, scheduling restart.
Jan 10 16:37:54 ubuntu-xenial systemd[1]: Stopped concourse-worker.service.
Jan 10 16:37:54 ubuntu-xenial systemd[1]: concourse-worker.service: Failed to load environment files: No such file or directory
Jan 10 16:37:54 ubuntu-xenial systemd[1]: concourse-worker.service: Failed to run &apos;start&apos; task: No such file or directory
Jan 10 16:37:54 ubuntu-xenial systemd[1]: Failed to start concourse-worker.service.
Jan 10 16:37:54 ubuntu-xenial systemd[1]: concourse-worker.service: Unit entered failed state.
Jan 10 16:37:54 ubuntu-xenial systemd[1]: concourse-worker.service: Failed with result &apos;resources&apos;.</span></pre><pre class="code-pre "><code langs><div class="secondary-code-label " title="Output">Output</div>&#x25CF; concourse-web.service - Concourse CI web process (ATC and TSA)
   Loaded: loaded (/etc/systemd/system/concourse-web.service; disabled; vendor preset: enabled)
   Active: <span class="highlight">active (running)</span> since Thu 2017-05-11 20:18:16 UTC; 1min 40s ago
 Main PID: 9954 (concourse)
    Tasks: 7
   Memory: 100.0M
      CPU: 2.058s
   CGroup: /system.slice/concourse-web.service
           &#x2514;&#x2500;9954 /usr/local/bin/concourse web

May 11 20:19:51 testatc concourse[9954]: {&quot;timestamp&quot;:&quot;1494533991.818562269&quot;,&quot;source&quot;:&quot;tsa&quot;,&quot;message&quot;:&quot;tsa.connection.keepalive&quot;,&quot;log_level&quot;:1,&quot;data&quot;:{&quot;remote&quot;:&quot;127.0.0.1:48764&quot;,&quot;session&quot;:&quot;1&quot;,&quot;type&quot;:&quot;keepalive&quot;}}
. . .

&#x25CF; concourse-worker.service - Concourse CI worker process
   Loaded: loaded (/etc/systemd/system/concourse-worker.service; disabled; vendor preset: enabled)
   Active: <span class="highlight">active (running)</span> since Thu 2017-05-11 20:18:16 UTC; 1min 39s ago
 Main PID: 9960 (concourse)
    Tasks: 9
   Memory: 619.6M
      CPU: 20.353s
   CGroup: /system.slice/concourse-worker.service
           &#x2514;&#x2500;9960 /usr/local/bin/concourse worker

May 11 20:19:12 testatc concourse[9960]: {&quot;timestamp&quot;:&quot;1494533952.909682751&quot;,&quot;source&quot;:&quot;tsa&quot;,&quot;message&quot;:&quot;tsa.connection.channel.forward-worker.heartbeat.start&quot;,&quot;log_level&quot;:1,&quot;data&quot;:{&quot;remote&quot;:&quot;127.0.0.1:48764&quot;,&quot;session&quot;:&quot;1.1.1.7&quot;,&quot;worker-address&quot;:&quot;127.0.0.1:38993&quot;,&quot;worker-platform&quot;:&quot;linux&quot;,&quot;worker-tags&quot;:&quot;&quot;}}
. . .
</code></pre>
<p>Check that both services read &#x201C;active (running)&#x201D; and that the log lines do not contain any obvious errors.  Pay special attention to the <code>web</code> service to make sure that the log lines do not indicate problems connecting to the database.</p>

<p>If the services started successfully, enable them so that they will start each time the server boots:</p>
<pre class="code-pre command failing"><span>&#x10102; </span><code langs><ul class="prefixed"><li class="line" prefix="$">sudo systemctl enable concourse-web concourse-worker
</li></ul></code><br><br><span>&#xFE0F;&#x2755;error: Failed to execute operation: Invalid argument
</span><span> exit code: 1</span><span> command output:<br> </span></pre>
<h2 id="check-access-on-the-command-line-and-through-the-web-interface">Check Access On the Command Line and Through the Web Interface</h2>

<p>Now that the Concourse services is running, we should check that we have access.</p>

<h3 id="checking-access-on-the-command-line">Checking Access On the Command Line</h3>

<p>First, let&#x2019;s check that we can access the Concourse service with the <code>fly</code> command line client.</p>

<p>We have to log in using the administrative username and password that we configured in the <code>/etc/concourse/web_environment</code> file using the <code>login</code> subcommand.  A single <code>fly</code> binary can be used to contact and manage multiple Concourse servers, so the command uses a concept called &#x201C;targets&#x201D; as an alias for different servers.  We will call our target &#x201C;local&#x201D; to log into the local Concourse server:</p>
<pre class="code-pre command failing"><span>&#x10102; </span><code langs><ul class="prefixed"><li class="line" prefix="$">fly -t local login -c http://127.0.0.1:8080
</li></ul></code><br><br><span>&#xFE0F;&#x2755;error: /tmp/bf025913337da6c44e9415d61817f85a.sh: line 3: fly: command not found
</span><span> exit code: 127</span><span> command output:<br> </span></pre>
<p>You will be prompted for the username and password for the <code>main</code> team, which we set in the <code>web_environments</code> file.  After entering your credentials, &#x201C;target saved&#x201D; should be displayed:</p>
<pre class="code-pre "><code langs><div class="secondary-code-label " title="Output">Output</div>logging in to team &apos;main&apos;

username: <span class="highlight">sammy</span>
password: 

target saved
</code></pre>
<p>This indicates that we were able to log in successfully.  While we are here, let&#x2019;s verify that the worker process was able to successfully register to the TSA component by typing:</p>
<pre class="code-pre command failing"><span>&#x10102; </span><code langs><ul class="prefixed"><li class="line" prefix="$">fly -t local workers
</li></ul></code><br><br><span>&#xFE0F;&#x2755;error: bash: fly: command not found
</span><span> exit code: 127</span><span> command output:<br> </span></pre><pre class="code-pre "><code langs><div class="secondary-code-label " title="Output">Output</div>name              containers  platform  tags  team  state    version
concourse-server  0           linux     none  none  running  1.0
</code></pre>
<p>The <code>fly</code> command is used to configure pipelines and manage the Concourse CI service.  The <code>fly help</code> command provides information about additional commands.</p>

<h3 id="checking-access-through-the-web-interface">Checking Access Through the Web Interface</h3>

<p>Next, check web access by visiting your server&#x2019;s IP address followed by <code>:8080</code> in a web browser:</p>
<pre class="code-pre "><code langs>http://<span class="highlight">servers_public_IP</span>:8080
</code></pre>
<p>You should be able to access the initial Concourse CI page:</p>

<p><img src="../steps/https:/assets.digitalocean.com/articles/concourseci_install_1604/initial_screen.png" alt="Concourse CI initial screen"></p>

<p>From here, you optionally can download the <code>fly</code> command to your local computer as a command line client by clicking on the image corresponding to your platform.  This allows you to manage your CI environment without logging into the server.  Remember to supply your server&#x2019;s public IP address instead of <code>127.0.0.1</code> when logging in with <code>fly</code> for the first time (read the warning about encryption below before logging in remotely).</p>

<p>If you click on the <strong>login</strong> link in the upper-right corner, you can log into the web interface.  First, you will be asked to select your team.  The <strong>main</strong> team, which is the administrative group, is the only available selection by default:</p>

<p><img src="../steps/https:/assets.digitalocean.com/articles/concourseci_install_1604/select_main_team.png" alt="Concourse CI select main team"></p>

<p>On the next page, you will be asked to enter your credentials.</p>

<p><span class="warning"><strong>Warning</strong>: The web interface and API gateway provided by Concourse CI are not encrypted by default, so your username and password will be submitted to the server as plain text.  If you are planning on using this installation for anything other than evaluation purposes, protect the web interface with SSL before logging in.  Follow our instructions on <a href="https://www.digitalocean.com/community/tutorials/how-to-secure-concourse-ci-with-ssl-using-nginx-on-ubuntu-16-04">setting up an SSL protected Nginx reverse proxy for Concourse CI</a> to configure secure access.<br></span></p>

<p>After entering the credentials you configured within the <code>web_environment</code> file, you will be logged in and taken back to the default placeholder interface:</p>

<p><img src="../steps/https:/assets.digitalocean.com/articles/concourseci_install_1604/placeholder_interface.png" alt="Concourse CI select main team"></p>

<p>Once you submit your pipeline configuration to the server with <code>fly</code>, this screen will be replace by an interface where you can monitor your pipeline activity.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In this guide, we installed PostgreSQL and the Concourse binaries, set up encryption keys, and configured Concourse and network access.  After starting the services, we logged in locally using the <code>fly</code> command and accessed the web interface to confirm functionality.</p>

<p>As mentioned earlier, before you use Concourse for actual work, it is important to protect the web and API gateways with SSL.  Follow our guide on <a href="https://www.digitalocean.com/community/tutorials/how-to-secure-concourse-ci-with-ssl-using-nginx-on-ubuntu-16-04">setting up an SSL reverse proxy for Concourse CI with Nginx</a> to configure secure access to your server before interacting with the server remotely.</p>

<p>To learn how to use <code>fly</code> to add pipelines to your Concourse server, check out the <a href="https://concourse.ci/hello-world.html">&#x201C;hello world&#x201D; example in the Concourse documentation</a>.</p>

    </div>
</div>

<div class="tutorial-footer">
  
<div class="tutorial-footer-details">

  <div class="postable-info-bar-container">
  <div class="postable-info-bar">

    <div class="author-byline">
      <div class="component-collaborators-container">
  <ul class="component-collaborators-content">
        <li class="collaborator-byline-avatar">
          <a href="/community/users/jellingwood">
            <img alt="jellingwood" class="avatar avatar-large" src="../steps/https:/secure.gravatar.com/avatar/60d901f61a6146e14a3e989bc1f4ef11?secure=true&amp;d=identicon" width="80" height="80">
</a>        </li>

    <li class="collaborators-byline-data">
        <p class="names">By <a href="/community/users/jellingwood">Justin Ellingwood</a></p>

      <p>
      </p>
    </li>
  </ul>
</div>

    </div>
  </div>
</div>


  <div class="section-content tutorial-contributors one">
    <div class="component-collaborators-container">
      <ul class="component-collaborators-content">



        <li class="collaborators-byline-data">
        </li>
      </ul>
    </div>
  </div>

    
<div class="hsb--content">
  <div class="hsb--undo hsb--hide">
    <span class="icon icon-helpfulness-upvoted"></span>
    <span class="hsb--question">You rated this helpful.</span>
    <button name="button" type="submit" class="hsb--button-down hsb--vote-down-js" data-upvotable-type="Tutorial">Undo</button>
  </div>

  <div class="hsb--flagging-undo hsb--hide">
    <span class="icon icon-helpfulness-flag"></span>
    <span class="hsb--question">You reported this tutorial.</span>
    <button name="button" type="submit" class="hsb--button-down hsb--unflagging-js">Undo</button>
  </div>

  <div class="hsb--do">
    <span class="hsb--question">Was this helpful?</span>
    <button name="button" type="submit" class="hsb--button hsb--vote-up-js" data-upvotable-id="2339" data-upvotable-type="Tutorial">Yes</button>
    <button name="button" type="submit" class="hsb--button hsb--flagging-js" data-url="/community/tutorials/how-to-install-concourse-ci-on-ubuntu-16-04/flag" data-flaggable-id="2339">No</button>
  </div>

  <div class="hsb--social-and-comments">
    <div class="hsb--social-sharing">
      <a target="_blank" class="share-popup" href="http://twitter.com/share?text=How To Install Concourse CI on Ubuntu 16.04&amp;url=https://www.digitalocean.com/community/tutorials/how-to-install-concourse-ci-on-ubuntu-16-04?utm_content=how-to-install-concourse-ci-on-ubuntu-16-04&amp;utm_medium=community&amp;utm_source=twshare">
        <span class="icon icon-helpfulness-twitter"></span>
</a>
      <a target="_blank" class="share-popup" href="https://www.facebook.com/sharer/sharer.php?u=https://www.digitalocean.com/community/tutorials/how-to-install-concourse-ci-on-ubuntu-16-04?utm_content=how-to-install-concourse-ci-on-ubuntu-16-04&amp;utm_medium=community&amp;utm_source=fbshare">
        <span class="icon icon-helpfulness-facebook"></span>
</a>
      <a target="_blank" class="share-popup" href="https://news.ycombinator.com/submitlink?t=How To Install Concourse CI on Ubuntu 16.04&amp;u=https://www.digitalocean.com/community/tutorials/how-to-install-concourse-ci-on-ubuntu-16-04?utm_content=how-to-install-concourse-ci-on-ubuntu-16-04&amp;utm_medium=community&amp;utm_source=hnshare">
        <span class="icon icon-helpfulness-hacker-news"></span>
</a>    </div>

    <div class="hsb--comment">
      <span class="icon icon-helpfulness-comment"></span>
      <strong class="amount">3</strong>
    </div>
  </div>
</div>


</div>



      <script>
    $(function() {
      window.initHelpfulnessActions(2339);
    });
  </script>
  <script>
    $(function() {
      var p, h5, panel, remainingSpace;
      var lineHeight = 31, clamp = 1;

      var panels = document.querySelectorAll('li .panel-data');

      for (var i = 0, len = panels.length; i < len; i++) {
        panel = panels[i];

        p = panel.querySelector('p');
        h5 = panel.querySelector('h5');
        remainingSpace = panel.offsetHeight - h5.offsetHeight;

        // Clamp text only when the remaining space isn't enought for p content.
        if (remainingSpace < p.scrollHeight) {
          clamp = parseInt(p.offsetHeight / lineHeight);

          p.style.cssText = "-webkit-line-clamp:" + clamp +
            "; display: -webkit-box; -webkit-box-orient: vertical;";
        }
      }
    });
  </script>

  <script>
    $(function() {
      if (!!window.init_sharing) {
        window.init_sharing();
      }
      new window.NewsletterSignup();
      new window.GrowableMarkdown({ target: '[data-growable-markdown]' });
    });
  </script>
  <script type="application/ld+json">
    {"@context":"http://schema.org","@type":"Article","name":"How To Install Concourse CI on Ubuntu 16.04","headline":"How To Install Concourse CI on Ubuntu 16.04","alternativeHeadline":"How To Install Concourse CI on Ubuntu 16.04","description":"Concourse CI is a modern, scalable continuous integration system designed to automate testing pipelines with a composable, declarative syntax. In this tutorial, we will demonstrate how to install Concourse CI on an Ubuntu 16.04 server. We will configure a PostgreSQL database to use as the backend, download and install the Concourse binaries, and then configure the web and worker processes that allow us to build and execute continuous integration pipelines.\r\n","keywords":"CI/CD,PostgreSQL","url":"https://www.digitalocean.com/community/tutorials/how-to-install-concourse-ci-on-ubuntu-16-04","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.digitalocean.com/community/tutorials/how-to-install-concourse-ci-on-ubuntu-16-04"},"dateModified":"2019-07-16T15:59:21Z","inLanguage":"en","accessMode":"textual","accessModeSufficient":"textual","isAccessibleForFree":true,"license":"https://creativecommons.org/licenses/by-nc-sa/4.0/","publishingPrinciples":"https://www.digitalocean.com/community/tutorials/technical-recommendations-and-best-practices-for-digitalocean-s-tutorials","author":[{"@type":"Person","name":"Justin Ellingwood","@id":"https://www.digitalocean.com/community/users/jellingwood"}],"datePublished":"2017-05-26T14:29:04Z","image":{"@type":"ImageObject","url":"https://www.digitalocean.com/assets/community/illustrations/DigitalOcean_Community-02cc36407e7a978ed4fc9ed98f3ed87c.jpg","height":375,"width":750},"interactionStatistic":[{"@type":"InteractionCounter","interactionType":"http://schema.org/LikeAction","userInteractionCount":"6"},{"@type":"InteractionCounter","interactionType":"http://schema.org/CommentAction","userInteractionCount":"2"}],"sourceOrganization":{"@type":"Organization","name":"DigitalOcean Community","url":"https://www.digitalocean.com/community"},"publisher":{"@type":"Organization","name":"DigitalOcean","url":"https://www.digitalocean.com","logo":{"@type":"ImageObject","url":"https://assets.digitalocean.com/logos/DO_Logo_horizontal_blue.png","width":351,"height":60}}}
  </script>


    
  

</body></html>